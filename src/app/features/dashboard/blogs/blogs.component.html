<div class="w-full">
  <!-- <div class="flex justify-between items-center mb-6">
    <h1 class="text-3xl font-bold text-gray-900 dark:text-white">
      Blog Management
    </h1>
    <button
      class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded"
      routerLink="/dashboard/blog/create"
    >
      Add New Blog
    </button>
  </div> -->

  <!-- Loading State -->
  <div *ngIf="loading" class="text-center py-8">
    <div
      class="inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"
    ></div>
    <p class="mt-2 text-gray-600 dark:text-gray-400">Loading blogs...</p>
  </div>

  <!-- Blogs List -->
  <div
    *ngIf="!loading && !error"
    class="bg-white dark:bg-gray-800 rounded-lg shadow-md"
  >
    <div class="p-6">
      <h2 class="text-xl font-semibold text-gray-900 dark:text-white">
        All Blogs
      </h2>
    </div>
    <div class="overflow-x-auto">
      <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700">
        <thead class="bg-gray-50 dark:bg-gray-700">
          <tr>
            <th
              scope="col"
              class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"
            >
              Title
            </th>
            <!-- <th
              scope="col"
              class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"
            >
              Description
            </th> -->
            <!-- <th
              scope="col"
              class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"
            >
              Created At
            </th> -->
            <th
              scope="col"
              class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"
            >
              Published
            </th>
            <!-- <th
              scope="col"
              class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"
            >
              Status
            </th> -->
            <th
              scope="col"
              class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"
            >
              Upload Image
            </th>
            <th scope="col" class="relative px-6 py-3">
              <span class="sr-only">Actions</span>
            </th>
          </tr>
        </thead>
        <tbody
          class="bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700"
        >
          <tr *ngFor="let blog of blogs">
            <td class="px-6 py-4 whitespace-nowrap">
              <div class="text-sm font-medium text-gray-900 dark:text-white">
                {{ blog.title || "Untitled" }}
              </div>
            </td>
            <!-- <td class="px-6 py-4 whitespace-nowrap">
              <div class="text-sm text-gray-500 dark:text-gray-400">
                {{ blog.short_desc || "No description" }}
              </div>
            </td> -->

            <!-- <td class="px-6 py-4 whitespace-nowrap">
              <div class="text-sm text-gray-500 dark:text-gray-400">
                {{ blog.createdAt | date : "short" }}
              </div>
            </td> -->
            <td class="px-6 py-4 whitespace-nowrap">
              <label class="inline-flex items-center cursor-pointer">
                <input
                  type="checkbox"
                  [checked]="blog.isPublished"
                  (change)="togglePublishStatus(blog)"
                  class="sr-only peer"
                />
                <div
                  class="relative w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600 dark:peer-checked:bg-blue-600"
                ></div>
              </label>
            </td>
            <!-- <td class="px-6 py-4 whitespace-nowrap">
              <span
                class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800"
              >
                {{ blog.isPublished === true ? "Published" : "Draft" }}
              </span>
            </td> -->
            <td class="px-6 py-4 whitespace-nowrap">
              <!-- Fixed-size Upload Dropzone -->
              <label
                *ngIf="!blog.image"
                for="dropzone-file-{{ blog._id }}"
                class="flex items-center justify-center w-20 h-8 border-2 border-gray-300 border-dashed rounded-lg cursor-pointer bg-gray-50 dark:bg-gray-700 hover:bg-gray-100 dark:hover:bg-gray-600 dark:border-gray-600 dark:hover:border-gray-500"
              >
                <svg
                  class="w-4 h-4 text-gray-500 dark:text-gray-400"
                  xmlns="http://www.w3.org/2000/svg"
                  fill="none"
                  viewBox="0 0 20 16"
                  stroke="currentColor"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M13 13h3a3 3 0 0 0 0-6h-.025A5.56 5.56 0 0 0 16 6.5 5.5 5.5 0 0 0 5.207 5.021C5.137 5.017 5.071 5 5 5a4 4 0 0 0 0 8h2.167M10 15V6m0 0L8 8m2-2 2 2"
                  />
                </svg>
                <input
                  id="dropzone-file-{{ blog._id }}"
                  type="file"
                  class="hidden"
                  (change)="onFileSelected($event, blog)"
                />
              </label>
            </td>
            <td
              class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium"
            >
              <a
                [routerLink]="['/blog', blog.slug]"
                class="text-indigo-600 hover:text-indigo-900"
                >View</a
              >
              <!-- [routerLink]="['/dashboard/blog/create', blog._id]" -->

              <a
                (click)="editBlog(blog.slug)"
                class="text-indigo-600 hover:text-indigo-900 ml-4"
                >Edit</a
              >
              <button
                (click)="deleteBlog(blog._id)"
                class="text-red-600 hover:text-red-900 ml-4"
              >
                Delete
              </button>
            </td>
          </tr>
          <tr *ngIf="blogs.length === 0">
            <td
              colspan="5"
              class="text-center py-8 text-gray-500 dark:text-gray-400"
            >
              No blogs found.
              <a
                routerLink="/dashboard/blog/create"
                class="text-blue-600 hover:underline"
                >Create your first blog</a
              >
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
  <!-- Error State -->

  <div
    *ngIf="error"
    class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4"
  >
    {{ error }}
    <button (click)="loadBlogs()" class="ml-2 underline">Retry</button>
  </div>
</div>
<p-toast position="bottom-right"></p-toast>
